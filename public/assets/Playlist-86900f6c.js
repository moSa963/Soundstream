import{p as L,j as e,R as j,c as b,J as P,G as B,F as E,S,T as A,b as w,d as v,ab as I,E as F,I as D,D as g,a0 as M,ac as O,B as R,ad as z}from"./index-ed23adba.js";import{S as T,P as V}from"./PaginationList-5828719e.js";const W=L(e.jsx("path",{d:"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"}),"Audiotrack"),$=({album:t,onTrackAdded:n})=>{const[a,s]=j.useState(!1),[o,d]=j.useState(null),[c,x]=j.useState(""),[i,k]=j.useState(!1),{setError:f,setInfo:m}=b(),C=r=>{const h=r.currentTarget.files[0];x(h.name),d(h)};return e.jsxs(j.Fragment,{children:[e.jsx(P,{onClick:()=>s(!0),children:e.jsx(W,{})}),e.jsxs(B,{open:a,setOpen:s,progress:i,children:[e.jsx(E,{fullWidth:!0,placeholder:"Title...",value:c,onChange:r=>x(r.target.value),label:"Title"}),e.jsxs(S,{direction:"row",spacing:2,sx:{width:"100%"},children:[e.jsx(A,{disabled:i,sx:{flex:1},children:(o==null?void 0:o.name)||"..."}),e.jsxs(w,{onClick:r=>r.currentTarget.children[0].click(),disabled:i,children:[e.jsx("input",{type:"file",accept:"Audio/*",style:{display:"none"},onChange:C}),"Chose"]})]}),e.jsxs(S,{direction:"row",spacing:2,children:[e.jsx(w,{disabled:!o||!c||i,onClick:()=>q(t.id,c,o,n,s,k,f,m),children:"Create"}),e.jsx(w,{disabled:i,color:"error",onClick:r=>s(!1),children:"Cancel"})]})]})]})},q=async(t,n,a,s,o,d,c,x)=>{d(!0);try{const k=await(await v(`api/tracks/albums/${t}`,"POST",{title:n,track:a})).json();s(k.data),o(!1),x("The track has been uplodaed successfully.")}catch(i){c(i)}d(!1)},G=({playlist:t,setLiked:n,large:a})=>{const{setError:s}=b();return e.jsx(I,{liked:t==null?void 0:t.liked,setLiked:()=>H(t,n,s),large:a})},H=async(t,n,a)=>{try{await v(`api/likes/playlists/${t==null?void 0:t.id}`,t!=null&&t.liked?"DELETE":"POST"),n(!(t!=null&&t.liked))}catch(s){a(s)}},J=({filter:t,setFilter:n,onTrackAdded:a,playlist:s,setPlaylist:o})=>{const{user:d}=F();return e.jsxs(S,{direction:"row",sx:{width:"100%",p:2},children:[(s==null?void 0:s.id)&&e.jsx(G,{large:!0,playlist:s,setLiked:c=>o({...s,liked:c})}),e.jsx(D,{value:t,onChange:c=>n(c.currentTarget.value),placeholder:"Search...",sx:{width:"100%",px:2,fontSize:20}}),(s==null?void 0:s.album)==!0&&(d==null?void 0:d.username)===(s==null?void 0:s.user.username)&&e.jsx($,{album:s,onTrackAdded:a})]})},Q=()=>e.jsxs(S,{spacing:1,sx:{width:"100%",py:5},children:[e.jsx(T,{variant:"rounded"}),e.jsx(g,{}),e.jsx(T,{variant:"rounded"}),e.jsx(g,{}),e.jsx(T,{variant:"rounded"}),e.jsx(g,{}),e.jsx(T,{variant:"rounded"}),e.jsx(g,{}),e.jsx(T,{variant:"rounded"})]}),K=({url:t,playlist:n,setPlaylist:a,actions:s,onAction:o,stickyHeader:d,sx:c})=>{const[x,i]=j.useState(""),{setIndices:k,setList:f}=M(),m=O("(max-width:600px)"),C=(r,h,u)=>{u(r),k([h])};return e.jsx(V,{url:t,Skeleton:Q,payload:n,loader:r=>{var h;return e.jsxs(R,{sx:{width:"100%",...c},children:[e.jsx(J,{playlist:n,onTrackAdded:u=>r.setList(l=>[...l,u]),filter:x,setPlaylist:a,setFilter:i}),e.jsx(z,{simple:m,onPlay:(u,l)=>C(r.list,l,f),tracks:(h=r.list)==null?void 0:h.filter(u=>u.title.toLowerCase().startsWith(x.toLowerCase())),setTracks:r.setList,actions:s,onAction:(u,l)=>o(u,l,r.setList),stickyHeader:d})]})}})};export{K as P};
